<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://xmlns.jcp.org/jsf/html"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

<h:body>
	<ui:composition template="/WEB-INF/facelets/template.xhtml">
		<ui:param name="page" value="Budget" />
		<ui:define name="title">

			<p style="font-weight: bold; color:blue; font-size:15px">Corner bit properties</p>
			<p>List out properties Corner bits</p>

			<div class="card">
				<h:form id="form">

					<!-- Spinner -->
					<p:dialog widgetVar="spinnerDialog" style="background-color: #3A3B3C;" modal="true"
							  closable="false" draggable="false" resizable="false"
							  showEffect="fade" hideEffect="fade">
						<p:graphicImage name="images/spin/spin1.gif" width="70px" height="70px" />
					</p:dialog>
					<br/>

					<!-- Properties Count -->
					<p:panel>
						<p:panelGrid columns="1" styleClass="noBorder" style="margin:auto; text-align:left;">
							<h:outputText style="font-weight: normal; font-style:italic; font-size:15px; color: blue;"
										  value="Selected properties : #{cornerBitService.totalRecords}" />
						</p:panelGrid>
					</p:panel>

					<!-- FLEX LAYOUT: Properties Left, Promotions Right -->
					<div style="display:flex; align-items:flex-start; gap:20px;">

						<!-- LEFT COLUMN : Properties -->
						<div style="flex:3;">
							<p:dataScroller value="#{cornerBitService.budgetModelList}" var="product" chunkSize="10">
<!--								<p:graphicImage width="300px" height="300px" stream="false" cache="false"-->
<!--												value="#{product.streamedContent}" />-->
								<p:panel style="width: 100%; height:340px; box-shadow: 10px 10px 5px grey;">

									<!-- owner name and type -->
									<h:panelGrid columns="4" style="font-size:15px; width:100%;">
										<h:outputText style="font-weight: bold;color: green;" value="Owner Name : #{product.name}" />
										<h:outputText style="font-weight: bold;color: black;" value="Property Type : #{product.pro_type}" />
										<h:outputText style="font-weight: bold;color: brown;"
													  value="Property for Sale in #{product.prim_location}, #{product.seco_location}" />
									</h:panelGrid>

									<!-- property details -->
									<h:panelGrid columns="5" style="font-size:15px; width:100%;">
										<p:graphicImage width="200" height="200" stream="false" cache="false"
														value="#{product.streamedContent}" />

										<h:panelGrid columns="2" style="background: #E5E4E2;" width="80%">
											<h:outputText value="Name :" />
											<h:outputText value="#{product.name}" />

											<h:outputText value="Contact :" />
											<h:outputText value="#{product.contactNo}" />

											<h:outputText value="Property Type :" />
											<h:outputText value="#{product.pro_type}" />
										</h:panelGrid>

										<h:panelGrid columns="1" width="60%">
											<h:outputText style="font-weight: bold;color: red;font-size: 15px"
														  value="Rs #{product.cost}" />

											<p:commandButton type="submit" value="Callback" icon="ui-icon-calculator"
															 style="background:#FFA500;font-weight: bold;color: black;font-size: 15px"
															 process="@this"
															 action="#{cornerBitService.storeSelectedPropertyInSession}"
															 onclick="PF('leadDialog1').show()">
												<f:setPropertyActionListener value="#{product}" target="#{cornerBitService.selectedProperty}" />
											</p:commandButton>

											<p:commandButton type="submit" value="Enquiry" icon="ui-icon-calculator"
															 style="background:#1E90FF;font-weight: bold;color: black;font-size: 15px; width:170px"
															 process="@this"
															 action="#{cornerBitService.storeSelectedPropertyInSession}"
															 onclick="PF('leadDialog1').show()">
												<f:setPropertyActionListener value="#{product}" target="#{cornerBitService.selectedProperty}" />
											</p:commandButton>
										</h:panelGrid>
									</h:panelGrid>

									<!-- location -->
									<h:panelGrid columns="1" width="100%">
										<h:outputText style="font-weight: normal; font-size: 15px"
													  value="Location : #{product.location}" />
									</h:panelGrid>

									<br/>

									<!-- links -->
									<h:panelGrid columns="4" width="100%">
										<h:outputText value="Posted : #{product.create_date}">
											<f:convertDateTime type="date" dateStyle="full"/>
										</h:outputText>

										<h:link value="Find Builders" outcome="builders.xhtml"
												style="font-weight: bold; font-size: 14px;color:black;" />
										<h:link value="Find Agents" outcome="agents.xhtml"
												style="font-weight: bold; font-size: 14px;color:black;" />
										<h:link value="Enquiry" outcome="enquiry.xhtml"
												style="font-weight: bold; font-size: 14px;color:black;" />
									</h:panelGrid>
								</p:panel>
								<br/>
							</p:dataScroller>
						</div>

						<!-- RIGHT COLUMN : Promotions -->
						<div style="flex:1; max-width:350px;">
							<p:panel header="Promotions" style="text-align:center;">
								<p:dataScroller value="#{cornerBitService.promoImageModel}" var="promo" chunkSize="5">
									<p:graphicImage width="300" height="500" stream="false" cache="false"
													value="#{promo.streamedContent}" style="margin-bottom:20px;" />
								</p:dataScroller>
							</p:panel>
						</div>

					</div>

					<!-- Pagination -->
					<p:panel>
						<p:panelGrid columns="3" styleClass="noBorder" style="margin:auto; text-align: left;">
							<h:commandButton value="Previous" action="#{cornerBitService.previousPage}"
											 disabled="#{cornerBitService.currentPage == 1}" />
							<h:commandButton value="Next" action="#{cornerBitService.nextPage}"
											 disabled="#{cornerBitService.currentPage * cornerBitService.pageSize >= cornerBitService.totalRecords}" />
							<h:outputText value="Page #{cornerBitService.currentPage} of #{cornerBitService.totalPages}" />
						</p:panelGrid>
					</p:panel>

				</h:form>

				<!-- Lead Dialog -->
				<h:form id="form1">
					<p:messages id="msgs"/>
					<p:dialog header="Call back details" widgetVar="leadDialog1" minHeight="600" width="700" showEffect="fade">
						<p:panel id="panelDialog" style="background-image: url('back1.jpg'); ">
							<p:panelGrid columns="3" styleClass="noBorder">
								<p:outputLabel style="font-weight: bold" for="name" value="Name : " />
								<p:inputText id="name" value="#{cornerBitService.custName}" required="true"
											 requiredMessage="Required Name"/>
								<p:message for="name" display="icon"/>

								<p:outputLabel style="font-weight: bold" for="ContactNumber" value="Contact Number : " />
								<p:inputMask id="ContactNumber" mask="9999999999" maxlength="10"
											 value="#{cornerBitService.contactNumber}" required="true"/>
								<p:message for="ContactNumber" display="icon"/>

								<h:outputText style="font-weight: bold;" value="Email : " />
								<h:inputText id="email" size="30" value="#{cornerBitService.email}"
											 validatorMessage="Invalid email format">
									<f:validateRegex pattern="^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)(\\.[A-Za-z]{2,})$" />
								</h:inputText>
								<p:message for="email" display="icon"/>
							</p:panelGrid>
						</p:panel>

						<br/>
						<h:commandButton value="Submit" type="submit" process="@this" update="@form"
										 actionListener="#{cornerBitService.submit}"
										 onclick="PF('spinnerDialog').show()">
							<p:resetInput target="form"/>
						</h:commandButton>
						<p:commandButton value="Reset" update="panelDialog" process="@this"
										 action="#{cornerBitService.reset}" styleClass="mr-2 ui-button-outlined"/>
					</p:dialog>

					<script type="text/javascript" src="resources/js/chatool.js"></script>
				</h:form>
			</div>
		</ui:define>
	</ui:composition>
</h:body>
</html>